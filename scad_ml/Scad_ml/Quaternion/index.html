<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Quaternion (scad_ml.Scad_ml.Quaternion)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">scad_ml</a> &#x00BB; <a href="../index.html">Scad_ml</a> &#x00BB; Quaternion</nav><header class="odoc-preamble"><h1>Module <code><span>Scad_ml.Quaternion</span></code></h1><p>Provides functions for the creation of and operations between <a href="https://en.wikipedia.org/wiki/Quaternion">quaternions</a>. These can be used to create composable and interpolatable rotations to be applied to 3d vectors (<a href="../Vec3/index.html#type-t"><code>Vec3.t</code></a>) directly, and <a href="../Scad/index.html#type-t"><code>Scad.t</code></a> through <a href="../MultMatrix/index.html#type-t"><code>MultMatrix.t</code></a>.</p></header><nav class="odoc-toc"><ul><li><a href="#basic-arithmetic">Basic Arithmetic</a></li><li><a href="#vector-math">Vector Math</a></li><li><a href="#matrix-conversions">Matrix Conversions</a></li><li><a href="#utilities">Utilities</a></li><li><a href="#vector-transformations">Vector Transformations</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-id" class="anchored"><a href="#val-id" class="anchor"></a><code><span><span class="keyword">val</span> id : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>The identity quaternion: <code>(0., 0., 0., 1.)</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-coefficients" class="anchored"><a href="#val-coefficients" class="anchor"></a><code><span><span class="keyword">val</span> coefficients : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float * float * float * float</span></code></div><div class="spec-doc"><p><code>coefficients t</code></p><p>Returns the imaginary (xyz) and real (w) parts which describe the quaternion <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-make" class="anchored"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : <span><a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>make ax angle</code></p><p>Create a quaternion representing a rotation of <code>angle</code> (in radians) around the vector <code>ax</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_euler" class="anchored"><a href="#val-of_euler" class="anchor"></a><code><span><span class="keyword">val</span> of_euler : <span><a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>of_euler v</code></p><p>Create a quaternion equivalent to the Euler angle rotations represented by <code>v</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_euler" class="anchored"><a href="#val-to_euler" class="anchor"></a><code><span><span class="keyword">val</span> to_euler : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Vec3/index.html#type-t">Vec3.t</a></span></code></div><div class="spec-doc"><p><code>to_euler t</code></p><p>Convert the quaternion <code>t</code> to equivalent Euler angles.</p></div></div><h2 id="basic-arithmetic"><a href="#basic-arithmetic" class="anchor"></a>Basic Arithmetic</h2><div class="odoc-spec"><div class="spec value" id="val-add" class="anchored"><a href="#val-add" class="anchor"></a><code><span><span class="keyword">val</span> add : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>add a b</code></p><p>Hadamard (element-wise) addition of quaternions <code>a</code> and <code>b</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sub" class="anchored"><a href="#val-sub" class="anchor"></a><code><span><span class="keyword">val</span> sub : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>sub a b</code></p><p>Hadamard (element-wise) subtraction of quaternion <code>b</code> from <code>a</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-mul" class="anchored"><a href="#val-mul" class="anchor"></a><code><span><span class="keyword">val</span> mul : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>mul a b</code></p><p>Quaternion multiplication of <code>a</code> and <code>b</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-negate" class="anchored"><a href="#val-negate" class="anchor"></a><code><span><span class="keyword">val</span> negate : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>negate t</code></p><p>Negation of all elements of <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sadd" class="anchored"><a href="#val-sadd" class="anchor"></a><code><span><span class="keyword">val</span> sadd : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>sadd t s</code></p><p>Add <code>s</code> to the magnitude of <code>t</code>, leaving the imaginary parts unchanged.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ssub" class="anchored"><a href="#val-ssub" class="anchor"></a><code><span><span class="keyword">val</span> ssub : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>ssub t s</code></p><p>Subtract <code>s</code> from the magnitude of <code>t</code>, leaving the imaginary parts unchanged.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ssub_neg" class="anchored"><a href="#val-ssub_neg" class="anchor"></a><code><span><span class="keyword">val</span> ssub_neg : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>ssub_neg t s</code></p><p>Negate the imaginary parts of <code>t</code>, and subtract the magnitude from <code>s</code> to obtain the new magnitude.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-smul" class="anchored"><a href="#val-smul" class="anchor"></a><code><span><span class="keyword">val</span> smul : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>smul t s</code></p><p>Element-wise multiplication of <code>t</code> by <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sdiv" class="anchored"><a href="#val-sdiv" class="anchor"></a><code><span><span class="keyword">val</span> sdiv : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>div_scalar t s</code></p><p>Element-wise division of <code>t</code> by <code>s</code>.</p></div></div><h2 id="vector-math"><a href="#vector-math" class="anchor"></a>Vector Math</h2><div class="odoc-spec"><div class="spec value" id="val-norm" class="anchored"><a href="#val-norm" class="anchor"></a><code><span><span class="keyword">val</span> norm : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div><div class="spec-doc"><p><code>norm t</code></p><p>Calculate the vector norm (a.k.a. magnitude) of <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-normalize" class="anchored"><a href="#val-normalize" class="anchor"></a><code><span><span class="keyword">val</span> normalize : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>normalize t</code></p><p>Normalize <code>t</code> to a quaternion for which the magnitude is equal to 1. e.g. <code>norm (normalize t) = 1.</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-dot" class="anchored"><a href="#val-dot" class="anchor"></a><code><span><span class="keyword">val</span> dot : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div><div class="spec-doc"><p><code>dot a b</code></p><p>Vector dot product of <code>a</code> and <code>b</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-conj" class="anchored"><a href="#val-conj" class="anchor"></a><code><span><span class="keyword">val</span> conj : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>conj t</code></p><p>Take the conjugate of the quaternion <code>t</code>, negating the imaginary parts (x, y, and z) of <code>t</code>, leaving the magnitude unchanged.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-distance" class="anchored"><a href="#val-distance" class="anchor"></a><code><span><span class="keyword">val</span> distance : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div><div class="spec-doc"><p><code>distance a b</code></p><p>Calculate the magnitude of the difference (Hadamard subtraction) between <code>a</code> and <code>b</code>.</p></div></div><h2 id="matrix-conversions"><a href="#matrix-conversions" class="anchor"></a>Matrix Conversions</h2><div class="odoc-spec"><div class="spec value" id="val-of_rotmatrix" class="anchored"><a href="#val-of_rotmatrix" class="anchor"></a><code><span><span class="keyword">val</span> of_rotmatrix : <span><a href="../RotMatrix/index.html#type-t">RotMatrix.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-to_rotmatrix" class="anchored"><a href="#val-to_rotmatrix" class="anchor"></a><code><span><span class="keyword">val</span> to_rotmatrix : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../RotMatrix/index.html#type-t">RotMatrix.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-to_multmatrix" class="anchored"><a href="#val-to_multmatrix" class="anchor"></a><code><span><span class="keyword">val</span> to_multmatrix : <span>?trans:<a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../MultMatrix/index.html#type-t">MultMatrix.t</a></span></code></div><div class="spec-doc"><p><code>to_multmatrix ?trans t</code></p><p>Convert quaternion <code>t</code> into a <a href="../MultMatrix/index.html#type-t"><code>MultMatrix.t</code></a>, optionally providing a translation vector <code>trans</code> to tack on.</p></div></div><h2 id="utilities"><a href="#utilities" class="anchor"></a>Utilities</h2><div class="odoc-spec"><div class="spec value" id="val-to_string" class="anchored"><a href="#val-to_string" class="anchor"></a><code><span><span class="keyword">val</span> to_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-get_x" class="anchored"><a href="#val-get_x" class="anchor"></a><code><span><span class="keyword">val</span> get_x : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-get_y" class="anchored"><a href="#val-get_y" class="anchor"></a><code><span><span class="keyword">val</span> get_y : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-get_z" class="anchored"><a href="#val-get_z" class="anchor"></a><code><span><span class="keyword">val</span> get_z : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-get_w" class="anchored"><a href="#val-get_w" class="anchor"></a><code><span><span class="keyword">val</span> get_w : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-slerp" class="anchored"><a href="#val-slerp" class="anchor"></a><code><span><span class="keyword">val</span> slerp : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>slerp a b step</code></p><p>Spherical linear interpotation. Adapted from <a href="https://github.com/KieranWynn/pyquaternion">pyquaternion</a>.</p></div></div><h2 id="vector-transformations"><a href="#vector-transformations" class="anchor"></a>Vector Transformations</h2><div class="odoc-spec"><div class="spec value" id="val-rotate_vec3" class="anchored"><a href="#val-rotate_vec3" class="anchor"></a><code><span><span class="keyword">val</span> rotate_vec3 : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Vec3/index.html#type-t">Vec3.t</a></span></code></div><div class="spec-doc"><p><code>rotate_vec3 t v</code></p><p>Rotate <code>v</code> with the quaternion <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-rotate_vec3_about_pt" class="anchored"><a href="#val-rotate_vec3_about_pt" class="anchor"></a><code><span><span class="keyword">val</span> rotate_vec3_about_pt : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Vec3/index.html#type-t">Vec3.t</a></span></code></div><div class="spec-doc"><p><code>rotate_vec3_about_pt t p v</code></p><p>Translates <code>v</code> along the vector <code>-p</code>, rotating the resulting vector with the quaternion <code>t</code>, and finally, moving back along the vector <code>p</code>. Functionally, rotating about the point <code>p</code> (rather than the origin).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-alignment" class="anchored"><a href="#val-alignment" class="anchor"></a><code><span><span class="keyword">val</span> alignment : <span><a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Vec3/index.html#type-t">Vec3.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>alignment a b</code></p><p>Calculate a quaternion that would bring <code>a</code> into alignment with <code>b</code>.</p></div></div></div></body></html>